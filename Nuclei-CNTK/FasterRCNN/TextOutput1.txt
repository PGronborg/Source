Using base model:   VGG16
lr_per_sample:      [0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 1e-05]
Training model for 20 epochs.
Training 136449349 parameters in 32 parameter tensors.
Learning rate per minibatch: 0.001
Momentum per minibatch: 0.9
Learning rate per minibatch: 0.002
Momentum per minibatch: 0.9
 Minibatch[   1- 100]: loss = 1.308723 * 100, metric = 25.94% * 100;
 Minibatch[ 101- 200]: loss = 1.076588 * 100, metric = 23.66% * 100;
 Minibatch[ 201- 300]: loss = 0.975325 * 100, metric = 20.63% * 100;
Finished Epoch[1 of 20]: [Training] loss = 1.106901 * 320, metric = 23.18% * 320 71.910s (  4.5 samples/s);
Finished Evaluation [1]: Minibatch[1-96]: metric = 26.61% * 96;
 Minibatch[   1- 100]: loss = 0.902382 * 100, metric = 19.05% * 100;
 Minibatch[ 101- 200]: loss = 0.799910 * 100, metric = 17.29% * 100;
 Minibatch[ 201- 300]: loss = 0.706640 * 100, metric = 15.63% * 100;
Finished Epoch[2 of 20]: [Training] loss = 0.794267 * 320, metric = 17.19% * 320 53.310s (  6.0 samples/s);
Finished Evaluation [2]: Minibatch[1-96]: metric = 26.34% * 96;
 Minibatch[   1- 100]: loss = 0.721548 * 100, metric = 16.32% * 100;
 Minibatch[ 101- 200]: loss = 0.640818 * 100, metric = 14.85% * 100;
 Minibatch[ 201- 300]: loss = 0.621888 * 100, metric = 14.20% * 100;
Finished Epoch[3 of 20]: [Training] loss = 0.657744 * 320, metric = 15.05% * 320 53.111s (  6.0 samples/s);
Finished Evaluation [3]: Minibatch[1-96]: metric = 20.84% * 96;
 Minibatch[   1- 100]: loss = 0.655039 * 100, metric = 14.89% * 100;
 Minibatch[ 101- 200]: loss = 0.586504 * 100, metric = 14.10% * 100;
 Minibatch[ 201- 300]: loss = 0.567735 * 100, metric = 13.37% * 100;
Finished Epoch[4 of 20]: [Training] loss = 0.600453 * 320, metric = 14.10% * 320 53.205s (  6.0 samples/s);
Finished Evaluation [4]: Minibatch[1-96]: metric = 27.56% * 96;
 Minibatch[   1- 100]: loss = 0.600696 * 100, metric = 14.32% * 100;
 Minibatch[ 101- 200]: loss = 0.545306 * 100, metric = 12.98% * 100;
 Minibatch[ 201- 300]: loss = 0.523197 * 100, metric = 12.73% * 100;
Finished Epoch[5 of 20]: [Training] loss = 0.555770 * 320, metric = 13.39% * 320 53.295s (  6.0 samples/s);
Finished Evaluation [5]: Minibatch[1-96]: metric = 19.14% * 96;
 Minibatch[   1- 100]: loss = 0.552512 * 100, metric = 13.70% * 100;
 Minibatch[ 101- 200]: loss = 0.518358 * 100, metric = 12.69% * 100;
 Minibatch[ 201- 300]: loss = 0.496405 * 100, metric = 12.41% * 100;
Finished Epoch[6 of 20]: [Training] loss = 0.524913 * 320, metric = 13.02% * 320 53.420s (  6.0 samples/s);
Finished Evaluation [6]: Minibatch[1-96]: metric = 26.27% * 96;
 Minibatch[   1- 100]: loss = 0.538664 * 100, metric = 13.14% * 100;
 Minibatch[ 101- 200]: loss = 0.496891 * 100, metric = 12.38% * 100;
 Minibatch[ 201- 300]: loss = 0.471782 * 100, metric = 11.77% * 100;
Finished Epoch[7 of 20]: [Training] loss = 0.500376 * 320, metric = 12.42% * 320 56.045s (  5.7 samples/s);
Finished Evaluation [7]: Minibatch[1-96]: metric = 19.95% * 96;
 Minibatch[   1- 100]: loss = 0.524833 * 100, metric = 12.86% * 100;
 Minibatch[ 101- 200]: loss = 0.479437 * 100, metric = 11.96% * 100;
 Minibatch[ 201- 300]: loss = 0.459715 * 100, metric = 11.66% * 100;
Finished Epoch[8 of 20]: [Training] loss = 0.485816 * 320, metric = 12.15% * 320 53.865s (  5.9 samples/s);
Finished Evaluation [8]: Minibatch[1-96]: metric = 24.67% * 96;
 Minibatch[   1- 100]: loss = 0.518290 * 100, metric = 12.99% * 100;
 Minibatch[ 101- 200]: loss = 0.450045 * 100, metric = 11.53% * 100;
 Minibatch[ 201- 300]: loss = 0.443868 * 100, metric = 11.52% * 100;
Finished Epoch[9 of 20]: [Training] loss = 0.466581 * 320, metric = 11.91% * 320 53.484s (  6.0 samples/s);
Finished Evaluation [9]: Minibatch[1-96]: metric = 19.67% * 96;
 Minibatch[   1- 100]: loss = 0.482984 * 100, metric = 12.03% * 100;
 Minibatch[ 101- 200]: loss = 0.432983 * 100, metric = 11.18% * 100;
 Minibatch[ 201- 300]: loss = 0.421665 * 100, metric = 11.33% * 100;
Finished Epoch[10 of 20]: [Training] loss = 0.443196 * 320, metric = 11.44% * 320 53.548s (  6.0 samples/s);
Finished Evaluation [10]: Minibatch[1-96]: metric = 25.00% * 96;
Learning rate per minibatch: 0.0001
Learning rate per minibatch: 0.0002
 Minibatch[   1- 100]: loss = 0.546839 * 100, metric = 13.46% * 100;
 Minibatch[ 101- 200]: loss = 0.436758 * 100, metric = 10.99% * 100;
 Minibatch[ 201- 300]: loss = 0.435778 * 100, metric = 11.44% * 100;
Finished Epoch[11 of 20]: [Training] loss = 0.470744 * 320, metric = 11.89% * 320 53.204s (  6.0 samples/s);
Finished Evaluation [11]: Minibatch[1-96]: metric = 17.33% * 96;
 Minibatch[   1- 100]: loss = 0.479605 * 100, metric = 12.29% * 100;
 Minibatch[ 101- 200]: loss = 0.399220 * 100, metric = 10.43% * 100;
 Minibatch[ 201- 300]: loss = 0.384650 * 100, metric = 9.98% * 100;
Finished Epoch[12 of 20]: [Training] loss = 0.419725 * 320, metric = 10.87% * 320 53.085s (  6.0 samples/s);
Finished Evaluation [12]: Minibatch[1-96]: metric = 24.22% * 96;
 Minibatch[   1- 100]: loss = 0.501781 * 100, metric = 12.64% * 100;
 Minibatch[ 101- 200]: loss = 0.415531 * 100, metric = 10.79% * 100;
 Minibatch[ 201- 300]: loss = 0.412266 * 100, metric = 10.68% * 100;
Finished Epoch[13 of 20]: [Training] loss = 0.441185 * 320, metric = 11.32% * 320 53.133s (  6.0 samples/s);
Finished Evaluation [13]: Minibatch[1-96]: metric = 17.76% * 96;
 Minibatch[   1- 100]: loss = 0.471265 * 100, metric = 12.04% * 100;
 Minibatch[ 101- 200]: loss = 0.384650 * 100, metric = 10.09% * 100;
 Minibatch[ 201- 300]: loss = 0.387334 * 100, metric = 10.21% * 100;
Finished Epoch[14 of 20]: [Training] loss = 0.412648 * 320, metric = 10.74% * 320 53.001s (  6.0 samples/s);
Finished Evaluation [14]: Minibatch[1-96]: metric = 24.25% * 96;
 Minibatch[   1- 100]: loss = 0.484209 * 100, metric = 12.33% * 100;
 Minibatch[ 101- 200]: loss = 0.403446 * 100, metric = 10.30% * 100;
 Minibatch[ 201- 300]: loss = 0.397356 * 100, metric = 10.63% * 100;
Finished Epoch[15 of 20]: [Training] loss = 0.426436 * 320, metric = 11.04% * 320 53.293s (  6.0 samples/s);
Finished Evaluation [15]: Minibatch[1-96]: metric = 18.17% * 96;
 Minibatch[   1- 100]: loss = 0.460662 * 100, metric = 11.75% * 100;
 Minibatch[ 101- 200]: loss = 0.388444 * 100, metric = 10.11% * 100;
 Minibatch[ 201- 300]: loss = 0.375460 * 100, metric = 9.68% * 100;
Finished Epoch[16 of 20]: [Training] loss = 0.405906 * 320, metric = 10.47% * 320 52.680s (  6.1 samples/s);
Finished Evaluation [16]: Minibatch[1-96]: metric = 23.74% * 96;
 Minibatch[   1- 100]: loss = 0.469778 * 100, metric = 12.07% * 100;
 Minibatch[ 101- 200]: loss = 0.405639 * 100, metric = 10.50% * 100;
 Minibatch[ 201- 300]: loss = 0.394484 * 100, metric = 10.49% * 100;
Finished Epoch[17 of 20]: [Training] loss = 0.421075 * 320, metric = 10.98% * 320 53.212s (  6.0 samples/s);
Finished Evaluation [17]: Minibatch[1-96]: metric = 18.04% * 96;
 Minibatch[   1- 100]: loss = 0.451999 * 100, metric = 11.45% * 100;
 Minibatch[ 101- 200]: loss = 0.383687 * 100, metric = 9.79% * 100;
 Minibatch[ 201- 300]: loss = 0.369502 * 100, metric = 9.71% * 100;
Finished Epoch[18 of 20]: [Training] loss = 0.401370 * 320, metric = 10.33% * 320 53.009s (  6.0 samples/s);
Finished Evaluation [18]: Minibatch[1-96]: metric = 23.23% * 96;
 Minibatch[   1- 100]: loss = 0.470789 * 100, metric = 12.27% * 100;
 Minibatch[ 101- 200]: loss = 0.384548 * 100, metric = 10.29% * 100;
 Minibatch[ 201- 300]: loss = 0.388160 * 100, metric = 10.23% * 100;
Finished Epoch[19 of 20]: [Training] loss = 0.412143 * 320, metric = 10.86% * 320 53.004s (  6.0 samples/s);
Finished Evaluation [19]: Minibatch[1-96]: metric = 17.50% * 96;
 Minibatch[   1- 100]: loss = 0.449348 * 100, metric = 11.48% * 100;
 Minibatch[ 101- 200]: loss = 0.390522 * 100, metric = 10.26% * 100;
 Minibatch[ 201- 300]: loss = 0.365516 * 100, metric = 9.78% * 100;
Finished Epoch[20 of 20]: [Training] loss = 0.399250 * 320, metric = 10.44% * 320 53.292s (  6.0 samples/s);
Finished Evaluation [20]: Minibatch[1-96]: metric = 23.20% * 96;
creating eval model
Stored eval model at /home/s124262/Source/Nuclei-CNTK/FasterRCNN/Output/faster_rcnn_eval_VGG16_e2e.model
Evaluating Faster R-CNN model for 96 images.
Number of rois before non-maximum suppression: 12452
Number of rois  after non-maximum suppression: 2915
AP for        Negative = 0.5819
AP for        Positive = 0.5810
Mean AP = 0.5814
